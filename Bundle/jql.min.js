var __defProp=Object.defineProperty;var __export=(target,all)=>{for(var name in all)__defProp(target,name,{get:all[name],enumerable:true})};var Attributes_exports={};__export(Attributes_exports,{html:()=>html,mathMl:()=>mathMl,svg:()=>svg,xml:()=>xml});var freeze=Object;var html=freeze(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","target","title","translate","type","usemap","valign","value","width","xmlns","slot"]);var svg=freeze(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]);var mathMl=freeze(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]);var xml=freeze(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]);var isLenient=false;var rawTags={a:{elem:HTMLAnchorElement,allowed:true},area:{elem:HTMLAreaElement,allowed:false},audio:{elem:HTMLAudioElement,allowed:false},br:{elem:HTMLBRElement,allowed:true},base:{elem:HTMLBaseElement,allowed:false},body:{elem:HTMLBodyElement,allowed:false},button:{elem:HTMLButtonElement,allowed:true},canvas:{elem:HTMLCanvasElement,allowed:false},dl:{elem:HTMLDListElement,allowed:true},data:{elem:HTMLDataElement,allowed:false},datalist:{elem:HTMLDataListElement,allowed:true},div:{elem:HTMLDivElement,allowed:true},embed:{elem:HTMLEmbedElement,allowed:false},fieldset:{elem:HTMLFieldSetElement,allowed:true},font:{elem:HTMLFontElement,allowed:false},form:{elem:HTMLFormElement,allowed:false},hr:{elem:HTMLHRElement,allowed:true},head:{elem:HTMLHeadElement,allowed:false},output:{elem:HTMLOutputElement,allowed:true},iframe:{elem:HTMLIFrameElement,allowed:false},frameset:{elem:HTMLFrameSetElement,allowed:false},img:{elem:HTMLImageElement,allowed:true},input:{elem:HTMLInputElement,allowed:true},li:{elem:HTMLLIElement,allowed:true},label:{elem:HTMLLabelElement,allowed:true},legend:{elem:HTMLLegendElement,allowed:true},link:{elem:HTMLLinkElement,allowed:false},map:{elem:HTMLMapElement,allowed:false},media:{elem:HTMLMediaElement,allowed:false},meta:{elem:HTMLMetaElement,allowed:false},meter:{elem:HTMLMeterElement,allowed:true},ol:{elem:HTMLOListElement,allowed:true},object:{elem:HTMLObjectElement,allowed:false},optgroup:{elem:HTMLOptGroupElement,allowed:true},option:{elem:HTMLOptionElement,allowed:true},p:{elem:HTMLParagraphElement,allowed:true},param:{elem:HTMLParamElement,allowed:true},picture:{elem:HTMLPictureElement,allowed:false},pre:{elem:HTMLPreElement,allowed:true},progress:{elem:HTMLProgressElement,allowed:false},quote:{elem:HTMLQuoteElement,allowed:true},script:{elem:HTMLScriptElement,allowed:false},select:{elem:HTMLSelectElement,allowed:true},source:{elem:HTMLSourceElement,allowed:false},span:{elem:HTMLSpanElement,allowed:true},style:{elem:HTMLStyleElement,allowed:true},caption:{elem:HTMLTableCaptionElement,allowed:true},td:{elem:HTMLTableCellElement,allowed:true},col:{elem:HTMLTableColElement,allowed:true},table:{elem:HTMLTableElement,allowed:true},tr:{elem:HTMLTableRowElement,allowed:true},template:{elem:HTMLTemplateElement,allowed:false},textarea:{elem:HTMLTextAreaElement,allowed:true},time:{elem:HTMLTimeElement,allowed:true},title:{elem:HTMLTitleElement,allowed:true},track:{elem:HTMLTrackElement,allowed:true},details:{elem:HTMLDetailsElement,allowed:false},ul:{elem:HTMLUListElement,allowed:true},video:{elem:HTMLVideoElement,allowed:false},del:{elem:HTMLModElement,allowed:true},ins:{elem:HTMLModElement,allowed:true},slot:{elem:HTMLSlotElement,allowed:false},blockquote:{elem:HTMLQuoteElement,allowed:true},svg:{elem:SVGElement,allowed:true},dialog:{name:"dialog",allowed:false},summary:{name:"summary",allowed:true},main:{name:"main",allowed:true},address:{name:"address",allowed:true},colgroup:{name:"colgroup",allowed:true},tbody:{name:"tbody",allowed:true},tfoot:{name:"tfoot",allowed:true},th:{name:"th",allowed:true},dd:{name:"dd",allowed:true},dt:{name:"dt",allowed:true},figcaption:{name:"figcaption",allowed:true},figure:{name:"figure",allowed:true},i:{name:"i",allowed:true},b:{name:"b",allowed:true},code:{name:"code",allowed:true},h1:{name:"h1",allowed:true},h2:{name:"h2",allowed:true},h3:{name:"h3",allowed:true},h4:{name:"h4",allowed:true},abbr:{name:"abbr",allowed:true},bdo:{name:"bdo",allowed:true},dfn:{name:"dfn",allowed:true},em:{name:"em",allowed:true},kbd:{name:"kbd",allowed:true},mark:{name:"mark",allowed:true},q:{name:"1",allowed:true},rb:{name:"rb",allowed:true},rp:{name:"rp",allowed:true},rt:{name:"rt",allowed:true},ruby:{name:"ruby",allowed:true},s:{name:"s",allowed:true},strike:{name:"strike",allowed:true,is:"deprecated"},samp:{name:"samp",allowed:true},small:{name:"small",allowed:true},strong:{name:"strong",allowed:true},sup:{name:"sup",allowed:true},sub:{name:"sub",allowed:true},u:{name:"u",allowed:true},var:{name:"var",allowed:true},wbr:{name:"wbr",allowed:true},nobr:{name:"nobr",allowed:false},tt:{name:"tt",allowed:true},noscript:{name:"noscript",allowed:true},comment:{name:"comment",allowed:false}};var tags=Object.values(rawTags);var HTMLTags_default={set lenient(value){isLenient=value},isAllowed(elem){const tagInSet=tags.find(tag=>tag.elem&&elem instanceof tag.elem||(elem.nodeName||"").toLowerCase()===tag.name);return tagInSet&&tagInSet.allowed||isLenient&&!tagInSet},setTagPermission(tagName,allowed=false){tagName=tagName.toLowerCase();if(rawTags[tagName]){rawTags[tagName]={...rawTags[tagName],allowed}}}};var logElementCreationErrors2Console=false;var attrRegExpStore={data:/data-[\-\w.\p{L}]/ui,validURL:/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,whiteSpace:/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g,notAllowedValues:/javascript|injected|noreferrer|alert|DataURL/gi};var logContingentErrors=elCreationInfo=>{if(logElementCreationErrors2Console&&Object.keys(elCreationInfo.removed).length){const msgs=Object.entries(elCreationInfo.removed).reduce((acc,[k,v])=>[...acc,`${k} => ${v}`],[]).join(`\\000A`);console.info(`JQL HTML creation errors:`);console.info(msgs)}};var cleanupHtml=elem=>{const template=document.createElement("template");const elCreationInfo={rawHTML:elem.outerHTML,removed:{}};template.innerHTML=`<div id="placeholder">${elem.outerHTML}</div>`;const el2Clean=template.content.querySelector("#placeholder");el2Clean.querySelectorAll("*").forEach(child=>{const isSVG=child instanceof SVGElement;[...child.attributes].forEach(attr=>{const name=attr.name.trim().toLowerCase();const value=attr.value.trim().toLowerCase().replace(attrRegExpStore.whiteSpace,``);const evilValue=name==="href"?!attrRegExpStore.validURL.test(value):attrRegExpStore.notAllowedValues.test(value);const evilAttrib=name.startsWith(`data`)?!attrRegExpStore.data.test(name):!Attributes_exports[isSVG?`svg`:`html`].find(a=>a===name);if(evilValue||evilAttrib){elCreationInfo.removed[`${attr.name}`]=`attribute/property (-value) not allowed, remove (value: ${truncate2SingleStr(attr.value||`none`,60)})`;child.removeAttribute(attr.name)}});const allowed=HTMLTags_default.isAllowed(child);if(!allowed){elCreationInfo.removed[`<${child.nodeName.toLowerCase()}>`]=`not allowed, not rendered (tag: ${truncate2SingleStr(child.outerHTML,60)})`;child.remove()}});logContingentErrors(elCreationInfo);return el2Clean.children[0]};var setTagPermission=HTMLTags_default.setTagPermission;var insertPositions={BeforeBegin:"beforebegin",AfterBegin:"afterbegin",BeforeEnd:"beforeend",AfterEnd:"afterend"};var htmlToVirtualElement=htmlString=>{const placeholder=Object.assign(document.createElement("div"),{id:"placeholder",innerHTML:htmlString.trim()});return placeholder.childNodes.length?cleanupHtml(placeholder):void 0};var element2DOM=(elem,root=document.body,position=insertPositions.BeforeEnd)=>{root=root.isJQL?root.first():root;if(elem){if(elem instanceof HTMLElement){return root.insertAdjacentElement(position,elem)}if(elem&&elem instanceof Comment||elem instanceof Text){if(position===insertPositions.BeforeEnd){root.appendChild(elem)}if(position===insertPositions.AfterBegin){root.insertBefore(elem,root.firstElementChild)}}}};var createElementFromHtmlString=htmlStr=>{htmlStr=htmlStr.trim();let nwElem=htmlToVirtualElement(htmlStr);if(htmlStr.startsWith(`<!--`)&&htmlStr.endsWith(`-->`)){return document.createComment(htmlStr.replace(/<!--|-->$/g,""))}if(!nwElem.children.length){return createElementFromHtmlString(`<span data-jqlcreationerror="1">${truncateHtmlStr(htmlStr,60)}</span>`)}return nwElem.children[0]};var handlers={};var HandlerFactory_default=$2=>{const metaHandler=evt=>handlers[evt.type].forEach(handler=>handler(evt));const createHandlerForHID=(HID,callback)=>{return evt=>{const target=evt.target.closest(HID);return target&&callback(evt,$2(target))}};const addListenerIfNotExisting=type=>!Object.keys(handlers).find(registeredType=>registeredType===type)&&document.addEventListener(type,metaHandler);return(extCollection,type,HIDselector,callback)=>{addListenerIfNotExisting(type);const fn=!HIDselector?callback:createHandlerForHID(HIDselector,callback);handlers=handlers[type]?{...handlers,[type]:handlers[type].concat(fn)}:{...handlers,[type]:[fn]}}};var empty=el=>el&&(el.textContent="");var setData=(el,keyValuePairs)=>{el&&isObjectAndNotArray(keyValuePairs)&&Object.entries(keyValuePairs).forEach(([key,value])=>el.dataset[key]=value)};var inputElems=[HTMLInputElement,HTMLSelectElement,HTMLTextAreaElement];var css=(el,keyOrKvPairs,value)=>{const{setStyle}=JQLClassFree_default;if(value&&keyOrKvPairs.constructor===String){keyOrKvPairs={[keyOrKvPairs]:value==="-"?"":value}}let nwClass=void 0;if(keyOrKvPairs.className){nwClass=keyOrKvPairs.className;delete keyOrKvPairs.className}const classExists=[...el.classList].find(c=>c.startsWith(`JQLCreated`)||nwClass&&c===nwClass);nwClass=classExists||nwClass||`JQLCreated_${randomString.randomHtmlElementId(12)}`;setStyle(`.${nwClass}`,keyOrKvPairs);el.classList.add(nwClass)};var assignAttrValues=(el,keyValuePairs)=>{el&&Object.entries(keyValuePairs).forEach(([key,value])=>{if(key.startsWith(`data`)){setData(el,{[key]:value})}if(key.toLowerCase()==="class"){value.split(/\s+/).forEach(v=>el.classList.add(`${v}`))}if(value.constructor===String){el[key]=value}})};var allMethods={straigthLoops:{toggleClass:(el,className)=>el.classList.toggle(className),toggleStyleFragments:(el,keyValuePairs)=>el&&Object.entries(keyValuePairs).forEach(([key,value])=>{if(value instanceof Function){value=value(el)}if(/color/i.test(key)){value=value.startsWith(`#`)?hex2RGBA(value):value.replace(/(,|,\s{2,})(\w)/g,(...args)=>`, ${args[2]}`)}el.style[key]=`${el.style[key]}`===`${value}`?"":value}),removeAttr:(el,name)=>el&&el.removeAttribute(name),toggleAttr:(el,name,value)=>el&&el.hasAttribute(name)?el.removeAttribute(name):el.setAttribute(name,value),empty,clear:empty,replaceClass:(el,className,...nwClassNames)=>{el.classList.remove(className);nwClassNames.forEach(name=>el.classList.add(name))},removeClass:(el,...classNames)=>classNames.forEach(cn=>el.classList.remove(cn)),addClass:(el,...classNames)=>el&&classNames.forEach(cn=>el.classList.add(cn)),show:el=>el.style.display=``,hide:el=>el.style.display=`none`,setData,assignAttrValues,attr(el,keyOrObj,value){if(!el){return true}if(value!==void 0){keyOrObj={[keyOrObj]:value}}if(!value&&keyOrObj.constructor===String){return el.getAttribute(keyOrObj)}Object.entries(keyOrObj).forEach(([key,value2])=>{const keyCompare=key.toLowerCase().trim();if(keyCompare===`style`){return css(el,value2,void 0)}if(keyCompare===`data`){return setData(el,value2)}if(value2 instanceof Object){return assignAttrValues(el,value2)}return el.setAttribute(key,value2)})},style:(el,keyOrKvPairs,value)=>{if(value&&keyOrKvPairs.constructor===String){keyOrKvPairs={[keyOrKvPairs]:value||"none"}}if(!Array.isArray(keyOrKvPairs)&&keyOrKvPairs.constructor===Object){Object.entries(keyOrKvPairs).forEach(([key,value2])=>el.style[key]=value2)}},css},instanceExtensions:{text:(self,textValue,append)=>{if(self.isEmpty()){return self}const cb=el=>el.textContent=append?el.textContent+textValue:textValue;if(!textValue){return self.first().textContent}return loop(self,cb)},each:(self,cb)=>loop(self,cb),remove:(self,selector)=>{const remover=el=>el.remove();if(selector){const selectedElements=self.find$(selector);!selectedElements.isEmpty()&&loop(selectedElements,remover);return}loop(self,remover)},computedStyle:(self,property)=>self.first()&&getComputedStyle(self.first())[property],getData:(self,dataAttribute,valueWhenFalsy)=>self.first()&&self.first().dataset&&self.first().dataset[dataAttribute]||valueWhenFalsy,isEmpty:self=>self.collection.length<1,is:(self,checkValue)=>{const firstElem=self.first();if(!firstElem){return true}switch(checkValue){case":visible":{return isVisible(firstElem)}case":hidden":return!isVisible(firstElem);case":disabled":return firstElem.getAttribute("readonly")||firstElem.getAttribute("disabled");default:return true}},hasClass:(self,...classNames)=>{const firstElem=self.first();return self.isEmpty()||!firstElem.classList.length?false:classNames.find(cn=>firstElem.classList.contains(cn))||false},replace:(self,oldChild,newChild)=>{const firstElem=self.first();if(newChild.isJQL){newChild=newChild.first()}if(firstElem&&oldChild){oldChild=oldChild.constructor===String?firstElem.querySelector(oldChild):oldChild.isJQL?oldChild.first():oldChild;if(oldChild&&newChild){oldChild.replaceWith(newChild)}}return self},replaceMe:(self,newChild)=>{newChild=newChild instanceof HTMLElement?new self.constructor(newChild):newChild;self.parent().replace(self,newChild);return newChild},val:(self,value2Set)=>{const firstElem=self.first();if(!firstElem||!inputElems.includes(firstElem["constructor"])){return self}if(value2Set===void 0){return firstElem.value}firstElem.value=`${value2Set}`.length<1?"":value2Set;return self},parent:self=>self.collection.length&&self.first().parentNode&&new self.constructor(self.first().parentNode)||self,append:(self,...elems2Append)=>{if(self.collection.length&&elems2Append.length){for(let i=0;i<elems2Append.length;i+=1){const elem=elems2Append[i];if(elem.constructor===String){self.collection.forEach(el=>el.appendChild(createElementFromHtmlString(elem)));return self}if(isNode(elems2Append[i])){self.collection.forEach(el=>el.appendChild(elem instanceof Comment?elem:elem.cloneNode(true)));return self}if(elems2Append[i].isJQL&&elems2Append[i].collection.length){if(elems2Append[i].isVirtual){elem.toDOM()}const elems=elem.collection;elem.remove();elems.forEach(e2a=>self.collection.forEach(el=>el.appendChild(e2a instanceof Comment?e2a:e2a.cloneNode(true))))}}}return self},prepend:(self,...elems2Prepend)=>{if(!self.isEmpty()&&elems2Prepend){for(let i=0;i<elems2Prepend.length;i+=1){const elem2Prepend=elems2Prepend[i];if(elem2Prepend.constructor===String){self.collection.forEach(el=>el.insertBefore(createElementFromHtmlString(elem2Prepend),el.firstChild));return self}if(isNode(elem2Prepend)){self.collection.forEach(el=>el.insertBefore(elem2Prepend instanceof Comment?elem2Prepend:elem2Prepend.cloneNode(true),el.firstChild));return self}if(elem2Prepend.isJQL&&!elem2Prepend.isEmpty()){const elems=elem2Prepend.collection.slice();elem2Prepend.remove();elems.forEach(e2a=>self.collection.forEach(el=>el&&el.insertBefore(e2a instanceof Comment?e2a:e2a.cloneNode(true),el.firstChild)))}}}return self},appendTo:(self,self2AppendTo)=>{if(!self2AppendTo.isJQL){self2AppendTo=self.virtual(self2AppendTo)}return self2AppendTo.append(self)},prependTo:(self,self2PrependTo)=>{if(!self2PrependTo.isJQL){self2PrependTo=self.virtual(self2PrependTo)}return self2PrependTo.prepend(self)},single:(self,indexOrSelector="0")=>{if(self.collection.length>0){if(isNaN(+indexOrSelector)&&self.find(indexOrSelector)){return self.find$(indexOrSelector)}const index=+indexOrSelector;return index<self.collection.length?JQLClassFree_default(self.collection[indexOrSelector]):JQLClassFree_default(self.collection.slice(-1))}else{return self}},toNodeList:self=>{const virtual=document.createElement(`div`);for(let elem of self.collection){const nodeClone=document.importNode(elem,true);nodeClone.removeAttribute(`id`);virtual.append(nodeClone)}return virtual.childNodes},duplicate:(self,toDOM=false)=>{const clonedCollection=self.toNodeList();return toDOM?JQLClassFree_default(clonedCollection):self.virtual(clonedCollection)},toDOM:(self,root=document.body,position=insertPositions.BeforeEnd)=>{if(self.isVirtual){self.isVirtual=false;inject2DOMTree(self.collection,root,position)}return self},first:(self,asself=false)=>{if(self.collection.length>0){return asself?self.single():self.collection[0]}return void 0},first$:(self,indexOrSelector)=>self.single(indexOrSelector),find:(self,selector)=>self.first()?.querySelectorAll(selector)||[],find$:(self,selector)=>{const found=self.collection.reduce((acc,el)=>[...acc,[...el.querySelectorAll(selector)]],[]).flat().filter(el=>el&&el instanceof HTMLElement);return found.length&&JQLClassFree_default(found[0])||$()},prop:(self,property,value)=>{if(!value){return self.collection.length?self.first()[property]:self}if(self.collection.length){return loop(self,el=>el[property]=value)}return self},on:(self,type,callback)=>{if(self.collection.length){const cssSelector=addHandlerId(self);JQLClassFree_default.handle(self,type,cssSelector,callback)}return self},html:(self,htmlValue,append)=>{if(htmlValue===void 0){return self.first()?.innerHTML}if(!self.isEmpty()){const nwElement=htmlValue.isJQL?htmlValue.first():createElementFromHtmlString(`<div>${htmlValue}</div>`);if(!(nwElement instanceof Comment)){const cb=el=>el.innerHTML=append?el.innerHTML+nwElement.innerHTML:nwElement.innerHTML;return loop(self,cb)}}return self},outerHtml:self=>(self.first()||{outerHTML:void 0}).outerHTML,htmlFor:(self,forQuery,htmlString="",append=false)=>{if(forQuery&&self.collection.length){const el2Change=self.find$(forQuery);if(!el2Change){return self}if(`{htmlValue}`.trim().length<1){el2Change.textContent="";return self}const nwElement=createElementFromHtmlString(`<div>${htmlString}</div>`);nwElement&&el2Change.html(nwElement.innerHTML,append)}return self},dimensions:self=>self.first()?.getBoundingClientRect(),delegate:(self,type,cssSelector,...callbacks)=>{callbacks.forEach(callback=>JQLClassFree_default.handle(self,type,cssSelector,callback));return self},ON:(self,type,...callbacks)=>{if(self.collection.length){callbacks.forEach(cb=>self.on(type,cb))}return self},trigger:(self,evtType,SpecifiedEvent=Event,options={})=>{if(self.collection.length){const evObj=new SpecifiedEvent(evtType,{...options,bubbles:options.bubbles??true});for(let elem of self.collection){elem.dispatchEvent(evObj)}}return self}}};var JQLMethods_default=allMethods;var logStyling=await fetch(`../src/Resource/defaultLogStyling.txt`).then(r=>r.text()).then(r=>r.split(`~RULE~`));var debugLog={get isOn(){return useLogging},isVisible:()=>isVisible(logBox()),on(){useLogging=true;if(!log2Console){const box=logBox()||createLogElement();box?.parentNode["classList"].add(`visible`)}Log(`Logging started (to ${log2Console?`console`:`document`})`)},off(){if(logBox()){Log(`Logging stopped`);logBox()?.parentNode.classList.remove(`visible`)}useLogging=false},toConsole(console2=false){log2Console=console2;useLogging=console2;console2&&document.querySelector(`#logBox`)?.remove()},remove:()=>{useLogging=false;document.querySelector(`#logBox`).remove()},hide:()=>logBox()?.parentNode.classList.remove(`visible`),show:()=>logBox()?.parentNode.classList.add(`visible`),reversed(reverse=true){reverseLogging=reverse;Log(`Reverse logging reset: now logging ${reverse?`bottom to top (latest first)`:`top to bottom (latest last)`}`)},clear(){const box=logBox();box&&(box.textContent=``);Log(`Cleared`)}};var logSystem=false;var useLogging=false;var log2Console=false;var reverseLogging=true;var logBox=()=>document.querySelector(`#jql_logger`);var useHtml=true;var createLogElement=()=>{const setStyle=JQLClassFree_default.createStyle(`JQLLogCSS`);setStyling4Log(setStyle);const jql_logger_element_name=useHtml?`div`:`pre`;const loggingFieldSet=`<div id="logBox"><div class="legend"><div></div></div><${jql_logger_element_name} id="jql_logger"></${jql_logger_element_name}></div>`;element2DOM(createElementFromHtmlString(loggingFieldSet),void 0,insertPositions.AfterBegin);return document.querySelector(`#jql_logger`)};var decodeForConsole=something=>something.constructor===String&&Object.assign(document.createElement(`textarea`),{innerHTML:something}).textContent||something;var Log=(...args)=>{if(!useLogging){return}if(!log2Console&&!logBox()){createLogElement()}const logLine=arg=>`${arg instanceof Object?JSON.stringify(arg,null,2):arg}
`;args.forEach(arg=>log2Console?console.log(decodeForConsole(arg)):logBox().insertAdjacentHTML(reverseLogging?`afterbegin`:`beforeend`,`${time()} ${logLine(arg.replace(/\n/g,`<br>`))}`))};var setSystemLogActiveState=tf=>logSystem=tf;var systemLog=(...logTxt)=>logSystem&&Log(...logTxt);function setStyling4Log(setStyle){logStyling.forEach(selector=>setStyle(selector));logStyling=void 0}var Popup_default=popupFactory;var popupStyling=await fetch(`../src/Resource/defaultPopupStyling.txt`).then(r=>r.text()).then(r=>r.split(`~RULE~`));function popupFactory($2){const wrappedBody=$2(document.body);const setStyle=$2.createStyle(`JQLPopupCSS`);initStyling(setStyle);let savedTimer,savedCallback;const clickOrTouch="ontouchstart"in document.documentElement?"touchend":"click";$2.delegate(clickOrTouch,`#closer, .between`,remove);const stillOpen=()=>{endTimer();modalWarner.hasClass(`active`)&&modalWarner.removeClass(`active`);modalWarner.addClass(`active`);savedTimer=setTimeout(()=>modalWarner.removeClass(`active`),2500);return true};const currentModalState={currentPopupIsModal:false,set isModal(tf){this.currentPopupIsModal=tf},get isModal(){return this.currentPopupIsModal},isModalActive(){return this.currentPopupIsModal&&popupBox.hasClass(`active`)&&stillOpen()}};const createElements=_=>{const popupBox2=$2(`<div class="popupContainer">`).append($2(`<span id="closer" class="closeHandleIcon"></span>`).prop(`title`,`Click here or anywhere outside the box to close`)).append(`<div class="popupBox"><div id="modalWarning"></div><div data-modalcontent></div></div>`);const closer2=$2(`#closer`);const between2=$2(`<div class="between"></div>`);return[popupBox2,between2,closer2,$2(`#modalWarning`)]};const[popupBox,between,closer,modalWarner]=createElements();const deActivate=()=>{$2(`.between`).removeClass(`active`).style({top:0});$2(`#closer, .popupContainer, #modalWarning`).removeClass(`active`);$2(`[data-modalcontent]`).empty()};const activate=(theBox,closeHndl)=>{$2(`.between, .popupContainer`).addClass(`active`);popupBox.style({height:`auto`,width:`auto`});between.style({top:`${scrollY}px`});wrappedBody.addClass(`popupActive`);if(closeHndl){closeHndl.addClass(`active`)}};const endTimer=()=>savedTimer&&clearTimeout(savedTimer);const doCreate=(message,reallyModal,callback)=>{currentModalState.isModal=reallyModal;savedCallback=callback;if(!message.isJQL&&message.constructor!==String){return createTimed($2(`<b style="color:red">Popup not created: invalid input</b>`),2)}endTimer();$2(`.popupBox > [data-modalcontent]`).empty().append(message.isJQL?message:$2(`<div>${message}</div>`));activate(popupBox,currentModalState.isModal?void 0:closer)};const create=(message,reallyModal=false,callback=void 0)=>!currentModalState.isModalActive()&&doCreate(message,reallyModal,callback);const createTimed=(message,closeAfter=2,callback=null)=>{if(currentModalState.isModalActive()){return}deActivate();create(message,false,callback);const remover=callback?()=>remove(callback):remove;savedTimer=setTimeout(remover,closeAfter*1e3)};function remove(evtOrCallback){endTimer();if(currentModalState.isModalActive()){return}const callback=evtOrCallback instanceof Function?evtOrCallback:savedCallback;if(callback&&callback instanceof Function){savedCallback=void 0;return callback()}deActivate();const time2Wait=parseFloat(popupBox.computedStyle(`transitionDuration`))*1e3;savedTimer=setTimeout(()=>wrappedBody.removeClass(`popupActive`),time2Wait)}const removeModal=callback=>{currentModalState.isModal=false;remove(callback)};return{create,createTimed,remove,removeModal}}function initStyling(setStyle){popupStyling.forEach(declaration=>setStyle(declaration));popupStyling=void 0}var styleFactory=(await import("https://kooiinc.github.io/LifeCSS/index.js")).default;var exts=JQLMethods_default.instanceExtensions;var loops=JQLMethods_default.straigthLoops;var pad0=(nr,n=2)=>`${nr}`.padStart(n,`0`);var isCommentOrTextNode=elem=>elem&&elem instanceof Comment||elem instanceof Text;var isNode=input=>[Text,HTMLElement,Comment].find(c=>input instanceof c);var isHtmlString=input=>input?.constructor===String&&/^<|>$/.test(`${input}`.trim());var isArrayOfHtmlStrings=input=>Array.isArray(input)&&!input?.find(s=>!isHtmlString(s));var isArrayOfHtmlElements=input=>Array.isArray(input)&&!input?.find(el=>!isNode(el));var ElemArray2HtmlString=elems=>elems?.filter(el=>el).reduce((acc,el)=>acc.concat(isCommentOrTextNode(el)?el.textContent:el.outerHTML),``);var input2Collection=input=>!input?[]:input instanceof NodeList?[...input]:isNode(input)?[input]:isArrayOfHtmlElements(input)?input:input.isJQL?input.collection:void 0;var setCollectionFromCssSelector=(input,root,self)=>{const selectorRoot=root!==document.body&&(input?.constructor===String&&input.toLowerCase()!=="body")?root:document;let errorStr=void 0;try{self.collection=[...selectorRoot.querySelectorAll(input)]}catch(err){errorStr=`Invalid CSS querySelector. [${input}]`}return errorStr??`(JQL log) css querySelector [${input}], output ${self.collection.length} element(s)`};var proxify=instance=>{const runExt=method=>(...args)=>method&&method instanceof Function&&method(proxify(instance),...args);const runLoop=method=>(...args)=>method&&method instanceof Function&&loop(proxify(instance),el=>method(el,...args));const proxyMe={get(obj,name){return loops[name]?runLoop(loops[name]):exts[name]?runExt(exts[name]):obj[name]}};return new Proxy(instance,proxyMe)};var randomString=(()=>{const characters=[...Array(26)].map((x,i)=>String.fromCharCode(i+65)).concat([...Array(26)].map((x,i)=>String.fromCharCode(i+97))).concat([...Array(10)].map((x,i)=>`${i}`));const getCharacters=excludes=>excludes&&characters.filter(c=>!~excludes.indexOf(c))||characters;const random=(len=12,excludes=[])=>{const chars=getCharacters(excludes);return[...Array(len)].map(()=>chars[Math.floor(Math.random()*chars.length)]).join("")};return{random,randomHtmlElementId:(len=12,excludes=[])=>{const charsWithoutNumbers=getCharacters(excludes.concat("0123456789".split("")));const firstChr=charsWithoutNumbers[Math.floor(Math.random()*charsWithoutNumbers.length)];return firstChr.concat(random(len-1,excludes))}}})();var loop=(instance,callback)=>{const cleanCollection=instance.collection.filter(el=>!isCommentOrTextNode(el));for(let i=0;i<cleanCollection.length;i+=1){callback(cleanCollection[i],i)}return instance};var inject2DOMTree=(collection=[],root=document.body,position=insertPositions.BeforeEnd)=>collection.reduce((acc,elem)=>{const created=elem&&isNode(elem)&&element2DOM(elem,root,position);return created?[...acc,created]:acc},[]);var addHandlerId=instance=>{const handleId=instance.first().dataset.hid||randomString.random(8);instance.setData({hid:handleId});return`[data-hid="${handleId}"]`};var isVisible=function(el){if(!el){return false}const elStyle=el.style;const computedStyle=getComputedStyle(el);const invisible=[elStyle.visibility,computedStyle.visibility].includes("hidden");const noDisplay=[elStyle.display,computedStyle.display].includes("none");const offscreen=el.offsetTop<0||el.offsetLeft+el.offsetWidth<0||el.offsetLeft>document.body.offsetWidth;const noOpacity=+computedStyle.opacity===0||+(elStyle.opacity||1)===0;return!(offscreen||noOpacity||noDisplay||invisible)};var truncateHtmlStr=(str,maxLength=120)=>str.trim().slice(0,maxLength).replace(/>\s+</g,`><`).replace(/</g,`&lt;`).replace(/\s{2,}/g,` `).replace(/\n/g,`\\n`)+(str.length>maxLength?`&hellip;`:``).trim();var truncate2SingleStr=(str,maxLength=120)=>truncateHtmlStr(str,maxLength).replace(/&lt;/g,`<`).replace(/&hellip;/g,`...`);var time=()=>(d=>`[${pad0(d.getHours())}:${pad0(d.getMinutes())}:${pad0(d.getSeconds())}.${pad0(d.getMilliseconds(),3)}]`)(new Date);var isObjectAndNotArray=obj=>obj.constructor!==Date&&!Array.isArray(obj)&&JSON.stringify(obj)==="{}"||obj.constructor!==String&&Object.keys(obj).length;var hex2Full=hex=>{hex=(hex.trim().startsWith("#")?hex.slice(1):hex).trim();return hex.length===3?[...hex].map(v=>v+v).join(""):hex};var hex2RGBA=function(hex,opacity=100){hex=hex2Full(hex.slice(1));const op=opacity%100!==0;return`rgb${op?"a":""}(${parseInt(hex.slice(0,2),16)}, ${parseInt(hex.slice(2,4),16)}, ${parseInt(hex.slice(-2),16)}${op?`, ${opacity/100}`:""})`};var addJQLStatics=$2=>{const virtual=html2=>$2(html2,document.createElement("br"));const setStyle=styleFactory({createWithId:`JQLStylesheet`});const createStyle=id=>styleFactory({createWithId:id});const handle=HandlerFactory_default($2);const delegate=(type,origin,...handlers2)=>{if(!origin||origin instanceof Function){origin instanceof Function&&handlers2.push(origin);return handle(null,type,null,...handlers2)}return handle(null,type,origin,...handlers2)};const staticMethods={setStyle,createStyle,virtual,debugLog,log:Log,handle,setSystemLogActiveState,insertPositions,popup:()=>Popup_default($2),text:(str,isComment=false)=>isComment?document.createComment(str):document.createTextNode(str),node:(selector,root=document.body)=>document.querySelector(selector,root),nodes:(selector,root=document.body)=>document.querySelectorAll(selector,root),delegate:(type,origin,...handlers2)=>{if(!origin||origin instanceof Function){origin instanceof Function&&handlers2.push(origin);return handle(null,type,null,...handlers2)}return handle(null,type,origin,...handlers2)}};Object.entries(staticMethods).forEach(([name,method])=>$2[name]=method);return $2};var logLineLength=80;var JQL=JQLFactory();var JQLClassFree_default=addJQLStatics(JQL);function JQLFactory(){return instantiate;function instantiate(input,root=document.body,position=insertPositions.BeforeEnd){const isRawHtml=isHtmlString(input);const isRawHtmlArray=isArrayOfHtmlStrings(input);const shouldCreateElements=!(root instanceof HTMLBRElement)&&isRawHtmlArray||isRawHtml;let instance={collection:input2Collection(input)??[],isVirtual:root instanceof HTMLBRElement,isJQL:true,insertPositions};const isRawElemCollection=isArrayOfHtmlElements(instance.collection);const logStr=`(JQL log) raw input: [${truncateHtmlStr(isRawHtmlArray?input.join(``):isRawElemCollection?`Element(s): ${instance.collection.map(el=>el.outerHTML||el.textContent).join(``)}`:input,logLineLength)}]`;if(instance.collection.length&&isRawElemCollection){systemLog(logStr);return proxify(instance)}if(shouldCreateElements){[input].flat().forEach(htmlFragment=>instance.collection.push(createElementFromHtmlString(htmlFragment)))}if(shouldCreateElements&&instance.collection.length>0){const errors=instance.collection.filter(el=>el.dataset?.jqlcreationerror);instance.collection=instance.collection.filter(el=>!el.dataset?.jqlcreationerror);systemLog(`${logStr}
  Created ${instance.isVirtual?` VIRTUAL`:``} (outerHTML truncated) [${truncateHtmlStr(ElemArray2HtmlString(instance.collection)||"sanitized: no elements remaining",logLineLength)}]`);errors.length&&console.error(`JQL: not rendered illegal html: "${errors.reduce((acc,el)=>acc.concat(`${el.textContent}
`),``).trim()}"`);if(!instance.isVirtual){inject2DOMTree(instance.collection,root,position)}errors.length&&console.error(`JQL: not rendered illegal html: "${errors.reduce((acc,el)=>acc.concat(`${el.textContent}
`),``).trim()}"`);return proxify(instance)}const forLog=setCollectionFromCssSelector(input,root,instance);systemLog(forLog);return proxify(instance)}}export{JQLClassFree_default as default};
