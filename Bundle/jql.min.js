var wt=Object.defineProperty;var Mt=(t,e)=>{for(var n in e)wt(t,n,{get:e[n],enumerable:!0})};var V={};Mt(V,{html:()=>Tt,mathMl:()=>Ht,svg:()=>At,xml:()=>Rt});var Q=Object,Tt=Q(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","target","title","translate","type","usemap","valign","value","width","xmlns","slot"]),At=Q(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Ht=Q(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Rt=Q(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]);var jt=await fetch("../src/Resource/defaultTagPermissions.json").then(t=>t.json()),D={isAllowed(t){let e=t?.nodeName.toLowerCase()||"none";return!!jt[e]},setTagPermission(t,e=!1){t=t.toLowerCase(),rawTags[t]&&(rawTags[t]=e)}};var Nt=!1;var W={data:/data-[\-\w.\p{L}]/ui,validURL:/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,whiteSpace:/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g,notAllowedValues:/javascript|injected|noreferrer|alert|DataURL/gi},Ft=t=>{if(Nt&&Object.keys(t.removed).length){let e=Object.entries(t.removed).reduce((n,[r,o])=>[...n,`${r} => ${o}`],[]).join("\\000A");console.info("JQL HTML creation errors:"),console.info(e)}},nt=t=>{let e=document.createElement("template"),n={rawHTML:t.outerHTML,removed:{}};e.innerHTML=`<div id="placeholder">${t.outerHTML}</div>`;let r=e.content.querySelector("#placeholder");return r.querySelectorAll("*").forEach(o=>{let i=l(o,SVGElement);[...o.attributes].forEach(c=>{let u=c.name.trim().toLowerCase(),g=c.value.trim().toLowerCase().replace(W.whiteSpace,""),C=u==="href"?!W.validURL.test(g):W.notAllowedValues.test(g),b=u.startsWith("data")?!W.data.test(u):!V[i?"svg":"html"].find(y=>y===u);(C||b)&&(n.removed[`${c.name}`]=`attribute/property (-value) not allowed, remove (value: ${P(c.value||"none",60)})`,o.removeAttribute(c.name))}),D.isAllowed(o)||(n.removed[`<${o.nodeName.toLowerCase()}>`]=`not allowed, not rendered (tag: ${P(o.outerHTML,60)})`,o.remove())}),Ft(n),r.children[0]};var It=D.setTagPermission;var v={BeforeBegin:"beforebegin",AfterBegin:"afterbegin",BeforeEnd:"beforeend",AfterEnd:"afterend"},kt=t=>{let e=Object.assign(document.createElement("div"),{id:"placeholder",innerHTML:t.trim()});return e.childNodes.length?nt(e):void 0},z=(t,e=document.body,n=v.BeforeEnd)=>{if(e=e.isJQL?e.first():e,t){if(l(t,HTMLElement))return e.insertAdjacentElement(n,t);l(t,Comment,Text)&&(n===v.BeforeEnd&&e.appendChild(t),n===v.AfterBegin&&e.insertBefore(t,e.firstElementChild))}},x=t=>{t=t.trim();let e=kt(t);return t.startsWith("<!--")&&t.endsWith("-->")?document.createComment(t.replace(/<!--|-->$/g,"")):e.children.length?e.children[0]:x(`<span data-jqlcreationerror="1">${j(t,60)}</span>`)};var rt=t=>t&&(t.textContent=""),U=(t,e)=>t.toLowerCase().trim()===e,G=(t,e)=>{t&&l(e,Object)&&Object.entries(e).forEach(([n,r])=>t.dataset[n]=r)},ot=(t,e,n)=>{let{setStyle:r}=E;n&&l(e,String)&&(e={[e]:n==="-"?"":n});let o;e.className&&(o=e.className,delete e.className),o=[...t.classList].find(m=>m.startsWith("JQLCreated")||o&&m===o)||o||`JQLCreated_${Y.randomHtmlElementId(12)}`,r(`.${o}`,e),t.classList.add(o)},it=(t,e)=>{t&&Object.entries(e).forEach(([n,r])=>{n.startsWith("data")&&G(t,{[n]:r}),U(n,"class")&&r.split(/\s+/).forEach(o=>t.classList.add(`${o}`)),l(r,String)&&(t[n]=r)})},qt={straigthLoops:{toggleClass:(t,e)=>t.classList.toggle(e),toggleStyleFragments:(t,e)=>t&&Object.entries(e).forEach(([n,r])=>{l(r,Function)&&(r=r(t)),/color/i.test(n)&&(r=r.startsWith("#")?ct(r):r.replace(/(,|,\s{2,})(\w)/g,(...o)=>`, ${o[2]}`)),t.style[n]=`${t.style[n]}`==`${r}`?"":r}),removeAttr:(t,e)=>t&&t.removeAttribute(e),toggleAttr:(t,e,n)=>t&&t.hasAttribute(e)?t.removeAttribute(e):t.setAttribute(e,n),empty:rt,clear:rt,replaceClass:(t,e,...n)=>{t.classList.remove(e),n.forEach(r=>t.classList.add(r))},removeClass:(t,...e)=>e.forEach(n=>t.classList.remove(n)),addClass:(t,...e)=>t&&e.forEach(n=>t.classList.add(n)),show:t=>t.style.display="",hide:t=>t.style.display="none",setData:G,assignAttrValues:it,attr(t,e,n){if(!t)return!0;if(n!==void 0&&(e={[e]:n}),!n&&l(e,String))return t.getAttribute(e);Object.entries(e).forEach(([r,o])=>U(r,"style")?ot(t,o,void 0):U(r,"data")?G(t,o):l(o,Object)?it(t,o):t.setAttribute(r,o))},style:(t,e,n)=>{n&&l(e,String)&&(e={[e]:n||"none"}),l(e,Object)&&Object.entries(e).forEach(([r,o])=>t.style[r]=o)},css:ot},instanceExtensions:{text:(t,e,n)=>{if(t.isEmpty())return t;let r=o=>o.textContent=n?o.textContent+e:e;return e?M(t,r):t.first().textContent},each:(t,e)=>M(t,e),remove:(t,e)=>{let n=r=>r.remove();if(e){let r=t.find$(e);!r.isEmpty()&&M(r,n);return}M(t,n)},computedStyle:(t,e)=>t.first()&&getComputedStyle(t.first())[e],getData:(t,e,n)=>t.first()&&t.first().dataset&&t.first().dataset[e]||n,isEmpty:t=>t.collection.length<1,is:(t,e)=>{let n=t.first();if(!n)return!0;switch(e){case":visible":return q(n);case":hidden":return!q(n);case":disabled":return n.getAttribute("readonly")||n.getAttribute("disabled");default:return!0}},hasClass:(t,...e)=>{let n=t.first();return t.isEmpty()||!n.classList.length?!1:e.find(r=>n.classList.contains(r))||!1},replace:(t,e,n)=>{let r=t.first();return n.isJQL&&(n=n.first()),r&&e&&(e=l(e,String)?r.querySelector(e):e.isJQL?e.first():e,e&&n&&e.replaceWith(n)),t},replaceMe:(t,e)=>(e=l(e,HTMLElement)?E(e):e,t.parent().replace(t,e),e),val:(t,e)=>{let n=t.first();return!n||!l(n,HTMLInputElement,HTMLSelectElement,HTMLTextAreaElement)?t:e===void 0?n.value:(n.value=`${e}`.length<1?"":e,t)},parent:t=>t.collection.length&&t.first().parentNode&&E(t.first().parentNode)||t,append:(t,...e)=>{if(t.collection.length&&e.length)for(let n=0;n<e.length;n+=1){let r=e[n];if(l(r,String))return t.collection.forEach(o=>o.appendChild(x(r))),t;if(N(e[n]))return t.collection.forEach(o=>o.appendChild(is(r,Comment)?r:r.cloneNode(!0))),t;if(e[n].isJQL&&e[n].collection.length){e[n].isVirtual&&r.toDOM();let o=r.collection;r.remove(),o.forEach(i=>t.collection.forEach(m=>m.appendChild(l(i,Comment)?i:i.cloneNode(!0))))}}return t},prepend:(t,...e)=>{if(!t.isEmpty()&&e)for(let n=0;n<e.length;n+=1){let r=e[n];if(l(r,String))return t.collection.forEach(o=>o.insertBefore(x(r),o.firstChild)),t;if(N(r))return t.collection.forEach(o=>o.insertBefore(l(r,Comment)?r:r.cloneNode(!0),o.firstChild)),t;if(r.isJQL&&!r.isEmpty()){let o=r.collection.slice();r.remove(),o.forEach(i=>t.collection.forEach(m=>m&&m.insertBefore(l(i,Comment)?i:i.cloneNode(!0),m.firstChild)))}}return t},appendTo:(t,e)=>(e.isJQL||(e=t.virtual(e)),e.append(t)),prependTo:(t,e)=>(e.isJQL||(e=t.virtual(e)),e.prepend(t)),single:(t,e="0")=>t.collection.length>0?isNaN(+e)&&t.find(e)?t.find$(e):+e<t.collection.length?E(t.collection[e]):E(t.collection.slice(-1)):t,toNodeList:t=>{let e=document.createElement("div");for(let n of t.collection){let r=document.importNode(n,!0);r.removeAttribute("id"),e.append(r)}return e.childNodes},duplicate:(t,e=!1)=>{let n=t.toNodeList();return e?E(n):t.virtual(n)},toDOM:(t,e=document.body,n=v.BeforeEnd)=>(t.isVirtual&&(t.isVirtual=!1,_(t.collection,e,n)),t),first:(t,e=!1)=>{if(t.collection.length>0)return e?t.single():t.collection[0]},first$:(t,e)=>t.single(e),find:(t,e)=>t.first()?.querySelectorAll(e)||[],find$:(t,e)=>{let n=t.collection.reduce((r,o)=>[...r,[...o.querySelectorAll(e)]],[]).flat().filter(r=>l(r,HTMLElement));return n.length&&E(n[0])||E()},prop:(t,e,n)=>n?t.collection.length?M(t,r=>r[e]=n):t:t.collection.length?t.first()[e]:t,on:(t,e,n)=>{if(t.collection.length){let r=st(t);E.handle(t,e,r,n)}return t},html:(t,e,n)=>{if(e===void 0)return t.first()?.innerHTML;if(!t.isEmpty()){let r=e.isJQL?e.first():x(`<div>${e}</div>`);if(!l(r,Comment))return M(t,i=>i.innerHTML=n?i.innerHTML+r.innerHTML:r.innerHTML)}return t},outerHtml:t=>(t.first()||{outerHTML:void 0}).outerHTML,htmlFor:(t,e,n="",r=!1)=>{if(e&&t.collection.length){let o=t.find$(e);if(!o)return t;if("{htmlValue}".trim().length<1)return o.textContent="",t;let i=x(`<div>${n}</div>`);i&&o.html(i.innerHTML,r)}return t},dimensions:t=>t.first()?.getBoundingClientRect(),delegate:(t,e,n,...r)=>(r.forEach(o=>E.handle(t,e,n,o)),t),ON:(t,e,...n)=>(t.collection.length&&n.forEach(r=>t.on(e,r)),t),trigger:(t,e,n=Event,r={})=>{if(t.collection.length){let o=new n(e,{...r,bubbles:r.bubbles??!0});for(let i of t.collection)i.dispatchEvent(o)}return t}}},Z=qt;var X=await fetch("../src/Resource/defaultLogStyling.txt").then(t=>t.text()).then(t=>t.split("~RULE~")),at={get isOn(){return F},isVisible:()=>q(w()),on(){F=!0,O||(w()||mt())?.parentNode.classList.add("visible"),H(`Logging started (to ${O?"console":"document"})`)},off(){w()&&(H("Logging stopped"),w()?.parentNode.classList.remove("visible")),F=!1},toConsole(t=!1){O=t,F=t,t&&document.querySelector("#logBox")?.remove()},remove:()=>{F=!1,document.querySelector("#logBox").remove()},hide:()=>w()?.parentNode.classList.remove("visible"),show:()=>w()?.parentNode.classList.add("visible"),reversed(t=!0){dt=t,H(`Reverse logging reset: now logging ${t?"bottom to top (latest first)":"top to bottom (latest last)"}`)},clear(){let t=w();t&&(t.textContent=""),H("Cleared")}},lt=!1,F=!1,O=!1,dt=!0,w=()=>document.querySelector("#jql_logger"),Ot=!0,mt=()=>{X&&Qt(E.createStyle("JQLLogCSS"));let t=Ot?"div":"pre",e=`<div id="logBox"><div class="legend"><div></div></div><${t} id="jql_logger"></${t}></div>`;return z(x(e),void 0,v.AfterBegin),document.querySelector("#jql_logger")},Jt=t=>l(t,String)&&Object.assign(document.createElement("textarea"),{innerHTML:t}).textContent||t,H=(...t)=>{if(!F)return;!O&&!w()&&mt();let e=n=>`${l(n,Object)?JSON.stringify(n,null,2):n}
`;t.forEach(n=>O?console.log(Jt(n)):w().insertAdjacentHTML(dt?"afterbegin":"beforeend",`${ft()} ${e(n.replace(/\n/g,"<br>"))}`))},ut=t=>lt=t,J=(...t)=>lt&&H(...t);function Qt(t){X?.forEach(e=>t(e)),X=void 0}var gt=Wt,pt=await fetch("../src/Resource/defaultPopupStyling.txt").then(t=>t.text()).then(t=>t.split("~RULE~"));function Wt(t){let e=t(document.body),n=t.createStyle("JQLPopupCSS");zt(n);let r,o,i="ontouchstart"in document.documentElement?"touchend":"click";t.delegate(i,"#closer, .between",L);let m=()=>(S(),y.hasClass("active")&&y.removeClass("active"),y.addClass("active"),r=setTimeout(()=>y.removeClass("active"),2500),!0),c=(()=>{let s=!1;return{set isModal(d){s=d},get isModal(){return s},get isModalActive(){return s&&g.hasClass("active")&&m()}}})(),u=s=>{let d=t('<div class="popupContainer">').append(t('<span id="closer" class="closeHandleIcon"></span>').prop("title","Click here or anywhere outside the box to close")).append('<div class="popupBox"><div id="modalWarning"></div><div data-modalcontent></div></div>'),p=t("#closer"),A=t('<div class="between"></div>');return[d,A,p,t("#modalWarning")]},[g,C,b,y]=u(),$=()=>{t(".between").removeClass("active").style({top:0}),t("#closer, .popupContainer, #modalWarning").removeClass("active"),t("[data-modalcontent]").empty()},k=(s,d)=>{t(".between, .popupContainer").addClass("active"),g.style({height:"auto",width:"auto"}),C.style({top:`${scrollY}px`}),e.addClass("popupActive"),d&&d.addClass("active")},S=()=>r&&clearTimeout(r),T=(s,d,p)=>{if(c.isModal=d,o=p,!s.isJQL&&!l(s,String))return h(t('<b style="color:red">Popup not created: invalid input</b>'),2);S(),t(".popupBox > [data-modalcontent]").empty().append(s.isJQL?s:t(`<div>${s}</div>`)),k(g,c.isModal?void 0:b)},f=(s,d=!1,p=void 0)=>!c.isModalActive&&T(s,d,p),h=(s,d=2,p=null)=>{if(c.isModalActive)return;$(),f(s,!1,p),r=setTimeout(p?()=>L(p):L,d*1e3)};function L(s){if(S(),c.isModalActive)return;let d=l(s,Function)?s:o;if(l(d,Function))return o=void 0,d();$();let p=parseFloat(g.computedStyle("transitionDuration"))*1e3;r=setTimeout(()=>e.removeClass("popupActive"),p)}return{create:f,createTimed:h,remove:L,removeModal:s=>{c.isModal=!1,L(s)}}}function zt(t){pt.forEach(e=>t(e)),pt=void 0}var R={},ht=t=>{let e=o=>R[o.type].forEach(i=>i(o)),n=(o,i)=>m=>{let c=m.target.closest(o);return c&&i(m,t(c))},r=o=>!Object.keys(R).find(i=>i===o)&&document.addEventListener(o,e);return(o,i,m,c)=>{r(i);let u=m?n(m,c):c;R=R[i]?{...R,[i]:R[i].concat(u)}:{...R,[i]:[u]}}};var K=_t;function _t({styleSheet:t,createWithId:e}){let{cssRuleFromText:n,checkAtRules:r,toDashedNotation:o,IS:i,shortenRule:m,consider:c,ruleExists:u,checkParams:g,atMedia2String:C,sheet:b}=Bt({styleSheet:t,createWithId:e}),y=(f,h)=>Object.entries(h).forEach(([L,a])=>f.style.setProperty(o(L),a)),$=(f,h,L=b)=>{if(!i(f,String)||!f.trim().length||/[;,]$/g.test(f.trim()))return console.error(`StylingFactory instance (setRules): [${f||"[no selector given]"}] is not a valid selector`);let a=u(f,!0),s=a||L.cssRules[L.insertRule(`${f} {}`,L.cssRules.length||0)];return c(()=>y(s,h),f,a)},k=f=>{let h=f.trim().split(/{/,2),L=h.shift().trim();if(!i(L,String)||!L.trim())return console.error(`StylingFactory instance (doParse): no (valid) selector could be extracted from rule ${m(f)}`);let a=n(h);return $(L,a)},S=f=>{let h=r(f);return h.done?h.existing:k(f)},T=(f,h)=>f.trim().startsWith("@media")?S(C(f,h)):$(f,h);return(f,h={})=>g(f,h)&&(Object.keys(h).length?T(f,h):S(f))}function Bt({styleSheet:t,createWithId:e}){let n="Note: The rule or some of its properties may not be supported by your browser (yet)",r=a=>a.replace(/([*\[\]()-+{}.$?\\])/g,"\\$1");t=e?(a=>document.head.insertAdjacentElement("beforeend",Object.assign(document.createElement("style"),{id:a,type:"text/css"})).sheet)(e):t;let i=(a,...s)=>{let d=s.length&&Array.isArray(s.slice(-1))?s.pop().join(""):"";return new RegExp((s.length&&a.raw.reduce((p,A,$t)=>p.concat(s[$t-1]||"").concat(A),"")||a.raw.join("")).split(`
`).map(p=>p.replace(/\s|\/\/.*$/g,"").trim().replace(/(@s!)/g," ")).join(""),d)},m=(a,s)=>[...t.rules].find(d=>s?$(d.selectorText||"",a):i`${r(a)}${[..."gim"]}`.test(d.cssText)),c=a=>/@import|@charset|@font-face/i.test(a)?{existing:T(a,0),done:!0}:C.test(a)?{ok:T(a,t.cssRules.length),done:!0}:{ok:!1,done:!1},u=(a,...s)=>!!s.find(d=>g(a,d)),g=(a,...s)=>{if(s.length>1)return u(a,...s);s=s.shift();let d="Invalid parameter(s)",p=a===0?Number:a===""?String:a?Object.getPrototypeOf(a)?.constructor:{name:d};return s?s===p?.__proto__||s===p:p?.name??d},C=i`@keyframes | @font-feature-values | @font-palette-values 
    | @layer | @namespace | @page | @counter-style | @container | @media ${["i"]}`,b=a=>a[0].trim().replace(/[}{]/,"").split(`
`).map(s=>s.trim()).filter(s=>s).reduce((s,d)=>{let[p,A]=[d.slice(0,d.indexOf(":")).trim(),d.slice(d.indexOf(":")+1).trim().replace(/;$|;.+(?=\/*).+\/$/,"")];return p&&A?{...s,[p]:A}:s},{}),y=a=>a.replace(/[A-Z]/g,s=>`-${s.toLowerCase()}`).replace(/[^--]^-|-$/,""),$=(a,s)=>a?.replace("::",":")===s?.replace("::",":"),k=(a,s)=>a&&g(a,String)&&a.trim().length&&g(s,Object)||(console.error("StylingFactory instance called with invalid parameters"),!1),S=a=>{let s=(a||"NO RULE").trim().slice(0,50).replace(/\n/g,"\\n").replace(/\s{2,}/g," ");return a.length>s.length?`${s.trim()}...truncated`:s},T=a=>{a=a.trim();let s=!!m(a.slice(0,a.indexOf("{")));try{return t.insertRule(`${a}`,t.cssRules.length),s}catch(d){return console.error(`StylingFactory instance (tryParse) ${d.name} Error:
${d.message}
Rule: ${S(a)}
${n}`),s}},f=(a,s,d)=>{try{return a(),d}catch(p){return console.error(`StylingFactory instance (tryAddOrModify) ${p.name} Error:
${p.message}
Rule: ${S(s)}
${n}`),d}},h=a=>Object.entries(a).map(([s,d])=>`${s}: ${d.trim()}`).join(`;
`);return{sheet:t,cssRuleFromText:b,checkAtRules:c,ruleExists:m,atMedia2String:(a,s)=>`${a.trim()} ${Object.entries(s).map(([d,p])=>`${d}: { ${h(p)}`)}`,toDashedNotation:y,checkParams:k,tryParse:T,consider:f,IS:g,shortenRule:S}}var yt=Z.instanceExtensions,Lt=Z.straigthLoops,B=(t,e=2)=>`${t}`.padStart(e,"0"),Vt=(t,...e)=>!!e.find(n=>l(t,n)),l=(t,...e)=>{if(e.length>1)return Vt(t,...e);e=e.shift();let n="Invalid parameter(s)",r=t===0?Number:t===""?String:t?Object.getPrototypeOf(t)?.constructor:{name:n};return e?e===r?.__proto__||e===r:r?.name??n},bt=t=>l(t,Comment,Text),N=t=>l(t,Text,HTMLElement,Comment),tt=t=>l(t,String)&&/^<|>$/.test(`${t}`.trim()),vt=t=>Array.isArray(t)&&!t?.find(e=>!tt(e)),et=t=>Array.isArray(t)&&!t?.find(e=>!N(e)),Et=t=>t?.filter(e=>e).reduce((e,n)=>e.concat(bt(n)?n.textContent:n.outerHTML),""),xt=t=>t?l(t,NodeList)?[...t]:N(t)?[t]:et(t)?t:t.isJQL?t.collection:void 0:[],St=(t,e,n)=>{let r=e!==document.body&&l(t,String)&&t.toLowerCase()!=="body"?e:document,o;try{n.collection=[...r.querySelectorAll(t)]}catch{o=`Invalid CSS querySelector. [${t}]`}return o??`(JQL log) css querySelector [${t}], output ${n.collection.length} element(s)`},I=t=>{let e=i=>(...m)=>l(i,Function)&&i(I(t),...m),n=i=>(...m)=>l(i,Function)&&M(I(t),c=>i(c,...m)),r=i=>Lt[i]&&n(Lt[i])||yt[i]&&e(yt[i]),o={get:(i,m)=>r(m)??(l(+m,Number)?i.collection?.[m]:i[m])};return new Proxy(t,o)},Y=(()=>{let t=[...Array(26)].map((r,o)=>String.fromCharCode(o+65)).concat([...Array(26)].map((r,o)=>String.fromCharCode(o+97))).concat([...Array(10)].map((r,o)=>`${o}`)),e=r=>r&&t.filter(o=>!~r.indexOf(o))||t,n=(r=12,o=[])=>{let i=e(o);return[...Array(r)].map(()=>i[Math.floor(Math.random()*i.length)]).join("")};return{random:n,randomHtmlElementId:(r=12,o=[])=>{let i=e(o.concat("0123456789".split("")));return i[Math.floor(Math.random()*i.length)].concat(n(r-1,o))}}})();var M=(t,e)=>{let n=t.collection.filter(r=>!bt(r));for(let r=0;r<n.length;r+=1)e(n[r],r);return t},_=(t=[],e=document.body,n=v.BeforeEnd)=>t.reduce((r,o)=>{let i=N(o)&&z(o,e,n);return i?[...r,i]:r},[]),st=t=>{let e=t.first().dataset.hid||Y.random(8);return t.setData({hid:e}),`[data-hid="${e}"]`},q=function(t){if(!t)return!1;let e=t.style,n=getComputedStyle(t),r=[e.visibility,n.visibility].includes("hidden"),o=[e.display,n.display].includes("none"),i=t.offsetTop<0||t.offsetLeft+t.offsetWidth<0||t.offsetLeft>document.body.offsetWidth,m=+n.opacity==0||+(e.opacity||1)==0;return!(i||m||o||r)};var j=(t,e=120)=>t.trim().slice(0,e).replace(/>\s+</g,"><").replace(/</g,"&lt;").replace(/\s{2,}/g," ").replace(/\n/g,"\\n")+(t.length>e?"&hellip;":"").trim(),P=(t,e=120)=>j(t,e).replace(/&lt;/g,"<").replace(/&hellip;/g,"..."),ft=()=>(t=>`[${B(t.getHours())}:${B(t.getMinutes())}:${B(t.getSeconds())}.${B(t.getMilliseconds(),3)}]`)(new Date),Dt=t=>(t=(t.trim().startsWith("#")?t.slice(1):t).trim(),t.length===3?[...t].map(e=>e+e).join(""):t),ct=function(t,e=100){t=Dt(t.slice(1));let n=e%100!==0;return`rgb${n?"a":""}(${parseInt(t.slice(0,2),16)}, ${parseInt(t.slice(2,4),16)}, ${parseInt(t.slice(-2),16)}${n?`, ${e/100}`:""})`},Ct=t=>{let e=c=>t(c,document.createElement("br")),n=K({createWithId:"JQLStylesheet"}),r=c=>K({createWithId:c}),o=ht(t),i=(c,u,...g)=>l(u,Function)?(g.push(u),o(null,c,null,...g)):o(null,c,u,...g);return Object.entries({setStyle:n,createStyle:r,virtual:e,debugLog:at,log:H,handle:o,setSystemLogActiveState:ut,insertPositions:v,popup:()=>gt(t),text:(c,u=!1)=>u?document.createComment(c):document.createTextNode(c),node:(c,u=document.body)=>document.querySelector(c,u),nodes:(c,u=document.body)=>document.querySelectorAll(c,u),delegate:(c,u,...g)=>l(u,Function)?(g.push(u),o(null,c,null,...g)):o(null,c,u,...g)}).forEach(([c,u])=>t[c]=u),t};var E=Ct(Pt());function Pt(){return function(e,n=document.body,r=v.BeforeEnd){let o=tt(e),i=vt(e),m=!l(n,HTMLBRElement)&&i||o,c={collection:xt(e)??[],isVirtual:l(n,HTMLBRElement),isJQL:!0,insertPositions:v},u=et(c.collection),g=`(JQL log) raw input: [${j(i?e.join(""):u?`Element(s): ${c.collection.map(b=>b.outerHTML||b.textContent).join("")}`:e,80)}]`;if(c.collection.length&&u)return J(g),I(c);if(m&&[e].flat().forEach(b=>c.collection.push(x(b))),m&&c.collection.length>0){let b=c.collection.filter(y=>y.dataset?.jqlcreationerror);return c.collection=c.collection.filter(y=>!y.dataset?.jqlcreationerror),J(`${g}
  Created ${c.isVirtual?" VIRTUAL":""} (outerHTML truncated) [${j(Et(c.collection)||"sanitized: no elements remaining",80)}]`),b.length&&console.error(`JQL: illegal html, not rendered: "${b.reduce((y,$)=>y.concat(`${$.textContent}
`),"").trim()}"`),c.isVirtual||_(c.collection,n,r),I(c)}let C=St(e,n,c);return J(C),I(c)}}export{E as default};
//# sourceMappingURL=jql.min.js.map
